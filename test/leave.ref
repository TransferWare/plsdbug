
Session altered.

  1  declare
  2
  3    procedure f1(i_count natural := 5)
  4    is
  5    begin
  6	 dbug.enter('f1');
  7	 if mod(:testcase, 2) = 1 and i_count = 0
  8	 then
  9	   null;
 10	 else
 11	   f1(i_count-1); -- since i_count is natural (>= 0) this will end in an exception
 12	 end if;
 13	 if :testcase in (3, 4)
 14	 then
 15	   -- Oops, forgot to dbug.leave;
 16	   null;
 17	 else
 18	   dbug.leave;
 19	 end if;
 20    exception
 21	 when others
 22	 then
 23	   if :testcase in (2, 4)
 24	   then
 25	     -- Oops, forgot to dbug.leave_on_error;
 26	     null;
 27	   else
 28	     dbug.leave_on_error;
 29	   end if;
 30	   raise;
 31    end f1;
 32
 33    procedure f2
 34    is
 35    begin
 36	 dbug.enter('f2');
 37	 f1;
 38	 dbug.leave;
 39    end f2;
 40
 41    procedure f3
 42    is
 43    begin
 44	 dbug.enter('f3');
 45	 f2;
 46	 if :testcase in (5)
 47	 then
 48	   -- Oops, forgot to dbug.leave;
 49	   null;
 50	 else
 51	   dbug.leave;
 52	 end if;
 53    exception
 54	 when others
 55	 then
 56	   if :testcase in (5)
 57	   then
 58	     -- Oops, forgot to dbug.leave_on_error;
 59	     null;
 60	   else
 61	     dbug.leave_on_error;
 62	   end if;
 63	   raise;
 64    end f3;
 65
 66  begin
 67    dbms_output.put_line('testcase: ' || :testcase || ' (log level ' || dbug.get_level || ')');
 68    dbug.activate('dbms_output');
 69    dbug.enter('main');
 70    f3;
 71    if :testcase in (7, 8)
 72    then
 73	 -- Oops, forgot to dbug.leave;
 74	 null;
 75    else
 76	 dbug.leave;
 77    end if;
 78  exception
 79    when others
 80    then
 81	 if :testcase in (6, 8)
 82	 then
 83	   -- Oops, forgot to dbug.leave_on_error;
 84	   null;
 85	 else
 86	   dbug.leave_on_error;
 87	 end if;
 88	 raise;
 89* end;
testcase: 8 (log level 2)
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|				    error: dbms_utility.format_error_backtrace: ORA-06512: at line 11
|				<
|				error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|				error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|				error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|			    <
|			    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|			    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|			    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|			<
|			error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|			error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|			error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|		    <
|		    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|		    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|		    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|		<
|		error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|		error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|		error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|	    <
|	    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|	    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|	    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 37
|	    error: dbms_utility.format_error_backtrace (3): ORA-06512: at line 45
ERROR: Popping 1 missing dbug.leave calls
|	<
|   <
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error
ORA-06512: at line 88


testcase: 7 (log level 2)
ERROR: Module name and other calls equal to the first one while the dbug call stack count is 2
<
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				<
|			    <
|			<
|		    <
|		<
|	    <
|	<
|   <
testcase: 6 (log level 2)
ERROR: Module name and other calls equal to the first one while the dbug call stack count is 2
<
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|				    error: dbms_utility.format_error_backtrace: ORA-06512: at line 11
|				<
|				error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|				error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|				error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|			    <
|			    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|			    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|			    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|			<
|			error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|			error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|			error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|		    <
|		    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|		    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|		    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|		<
|		error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|		error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|		error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 11
|	    <
|	    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|	    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|	    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 37
|	    error: dbms_utility.format_error_backtrace (3): ORA-06512: at line 45
ERROR: Popping 1 missing dbug.leave calls
|	<
|   <
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error
ORA-06512: at line 88


testcase: 5 (log level 2)
ERROR: Module name and other calls equal to the first one while the dbug call stack count is 2
<
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				<
|			    <
|			<
|		    <
|		<
|	    <
|	<
ERROR: Popping 1 missing dbug.leave calls
|   <
<
testcase: 4 (log level 2)
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|				    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|				    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 37
|				    error: dbms_utility.format_error_backtrace (3): ORA-06512: at line 45
ERROR: Popping 7 missing dbug.leave calls
|				<
|			    <
|			<
|		    <
|		<
|	    <
|	<
|   <
|   error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|   error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 63
|   error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 70
<
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error
ORA-06512: at line 88


testcase: 4 (log level 5)
error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 37
error: dbms_utility.format_error_backtrace (3): ORA-06512: at line 45
error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 63
error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 70
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error
ORA-06512: at line 88


testcase: 3 (log level 1)
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
ERROR: Popping 6 missing dbug.leave calls
|				<
|			    <
|			<
|		    <
|		<
|	    <
|	<
|   <
<
testcase: 2 (log level 1)
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				    error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|				    error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 30
|				    error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 37
|				    error: dbms_utility.format_error_backtrace (3): ORA-06512: at line 45
ERROR: Popping 7 missing dbug.leave calls
|				<
|			    <
|			<
|		    <
|		<
|	    <
|	<
|   <
|   error: sqlerrm: ORA-06502: PL/SQL: numeric or value error
|   error: dbms_utility.format_error_backtrace (1): ORA-06512: at line 63
|   error: dbms_utility.format_error_backtrace (2): ORA-06512: at line 70
<
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error
ORA-06512: at line 88


testcase: 1 (log level 1)
>main
|   >f3
|	>f2
|	    >f1
|		>f1
|		    >f1
|			>f1
|			    >f1
|				>f1
|				<
|			    <
|			<
|		    <
|		<
|	    <
|	<
|   <
<
testcase: 1 (log level 7)

 TESTCASE
---------
	1

